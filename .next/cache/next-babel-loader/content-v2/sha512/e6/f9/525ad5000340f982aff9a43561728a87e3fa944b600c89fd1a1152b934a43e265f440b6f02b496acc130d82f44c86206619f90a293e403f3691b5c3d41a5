{"ast":null,"code":"import _regeneratorRuntime from \"/Users/thejmdw/workspace/websites/next-commerce-test/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/thejmdw/workspace/websites/next-commerce-test/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport Cookies from 'js-cookie';\nimport { SHOPIFY_CHECKOUT_ID_COOKIE, SHOPIFY_CHECKOUT_URL_COOKIE, SHOPIFY_COOKIE_EXPIRE } from '../const';\nimport checkoutCreateMutation from './mutations/checkout-create';\nexport var checkoutCreate = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(fetch) {\n    var _data$checkoutCreate;\n\n    var data, checkout, checkoutId, options;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return fetch({\n              query: checkoutCreateMutation\n            });\n\n          case 2:\n            data = _context.sent;\n            checkout = (_data$checkoutCreate = data.checkoutCreate) === null || _data$checkoutCreate === void 0 ? void 0 : _data$checkoutCreate.checkout;\n            checkoutId = checkout === null || checkout === void 0 ? void 0 : checkout.id;\n\n            if (checkoutId) {\n              options = {\n                expires: SHOPIFY_COOKIE_EXPIRE\n              };\n              Cookies.set(SHOPIFY_CHECKOUT_ID_COOKIE, checkoutId, options);\n              Cookies.set(SHOPIFY_CHECKOUT_URL_COOKIE, checkout.webUrl, options);\n            }\n\n            return _context.abrupt(\"return\", checkout);\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function checkoutCreate(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport default checkoutCreate;","map":{"version":3,"sources":["/Users/thejmdw/workspace/websites/next-commerce-test/framework/shopify/utils/checkout-create.ts"],"names":["Cookies","SHOPIFY_CHECKOUT_ID_COOKIE","SHOPIFY_CHECKOUT_URL_COOKIE","SHOPIFY_COOKIE_EXPIRE","checkoutCreateMutation","checkoutCreate","fetch","query","data","checkout","checkoutId","id","options","expires","set","webUrl"],"mappings":";;AAAA,OAAOA,OAAP,MAAoB,WAApB;AAEA,SACEC,0BADF,EAEEC,2BAFF,EAGEC,qBAHF,QAIO,UAJP;AAMA,OAAOC,sBAAP,MAAmC,6BAAnC;AAGA,OAAO,IAAMC,cAAc;AAAA,sEAAG,iBAC5BC,KAD4B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAGTA,KAAK,CAAC;AACvBC,cAAAA,KAAK,EAAEH;AADgB,aAAD,CAHI;;AAAA;AAGtBI,YAAAA,IAHsB;AAOtBC,YAAAA,QAPsB,2BAOXD,IAAI,CAACH,cAPM,yDAOX,qBAAqBI,QAPV;AAQtBC,YAAAA,UARsB,GAQTD,QARS,aAQTA,QARS,uBAQTA,QAAQ,CAAEE,EARD;;AAU5B,gBAAID,UAAJ,EAAgB;AACRE,cAAAA,OADQ,GACE;AACdC,gBAAAA,OAAO,EAAEV;AADK,eADF;AAIdH,cAAAA,OAAO,CAACc,GAAR,CAAYb,0BAAZ,EAAwCS,UAAxC,EAAoDE,OAApD;AACAZ,cAAAA,OAAO,CAACc,GAAR,CAAYZ,2BAAZ,EAAyCO,QAAQ,CAACM,MAAlD,EAA0DH,OAA1D;AACD;;AAhB2B,6CAkBrBH,QAlBqB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAdJ,cAAc;AAAA;AAAA;AAAA,GAApB;AAqBP,eAAeA,cAAf","sourcesContent":["import Cookies from 'js-cookie'\n\nimport {\n  SHOPIFY_CHECKOUT_ID_COOKIE,\n  SHOPIFY_CHECKOUT_URL_COOKIE,\n  SHOPIFY_COOKIE_EXPIRE,\n} from '../const'\n\nimport checkoutCreateMutation from './mutations/checkout-create'\nimport { CheckoutCreatePayload } from '../schema'\n\nexport const checkoutCreate = async (\n  fetch: any\n): Promise<CheckoutCreatePayload> => {\n  const data = await fetch({\n    query: checkoutCreateMutation,\n  })\n\n  const checkout = data.checkoutCreate?.checkout\n  const checkoutId = checkout?.id\n\n  if (checkoutId) {\n    const options = {\n      expires: SHOPIFY_COOKIE_EXPIRE,\n    }\n    Cookies.set(SHOPIFY_CHECKOUT_ID_COOKIE, checkoutId, options)\n    Cookies.set(SHOPIFY_CHECKOUT_URL_COOKIE, checkout.webUrl, options)\n  }\n\n  return checkout\n}\n\nexport default checkoutCreate\n"]},"metadata":{},"sourceType":"module"}