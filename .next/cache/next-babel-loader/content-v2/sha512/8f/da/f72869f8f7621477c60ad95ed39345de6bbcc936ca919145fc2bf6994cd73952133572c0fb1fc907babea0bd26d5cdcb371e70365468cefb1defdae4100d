{"ast":null,"code":"import _defineProperty from \"/Users/thejmdw/workspace/websites/next-commerce-test/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/thejmdw/workspace/websites/next-commerce-test/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/thejmdw/workspace/websites/next-commerce-test/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectWithoutProperties from \"/Users/thejmdw/workspace/websites/next-commerce-test/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\n\nvar _jsxFileName = \"/Users/thejmdw/workspace/websites/next-commerce-test/components/wishlist/WishlistButton/WishlistButton.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from 'react';\nimport cn from 'classnames';\nimport { useUI } from '@components/ui';\nimport { Heart } from '@components/icons';\nimport useAddItem from '@framework/wishlist/use-add-item';\nimport useCustomer from '@framework/customer/use-customer';\nimport useWishlist from '@framework/wishlist/use-wishlist';\nimport useRemoveItem from '@framework/wishlist/use-remove-item';\n\nvar WishlistButton = function WishlistButton(_ref) {\n  _s();\n\n  var _data$items;\n\n  var productId = _ref.productId,\n      variant = _ref.variant,\n      className = _ref.className,\n      props = _objectWithoutProperties(_ref, [\"productId\", \"variant\", \"className\"]);\n\n  var _useWishlist = useWishlist(),\n      data = _useWishlist.data;\n\n  var addItem = useAddItem();\n  var removeItem = useRemoveItem();\n\n  var _useCustomer = useCustomer(),\n      customer = _useCustomer.data;\n\n  var _useUI = useUI(),\n      openModal = _useUI.openModal,\n      setModalView = _useUI.setModalView;\n\n  var _useState = useState(false),\n      loading = _useState[0],\n      setLoading = _useState[1]; // @ts-ignore Wishlist is not always enabled\n\n\n  var itemInWishlist = data === null || data === void 0 ? void 0 : (_data$items = data.items) === null || _data$items === void 0 ? void 0 : _data$items.find( // @ts-ignore Wishlist is not always enabled\n  function (item) {\n    return item.product_id === Number(productId) && item.variant_id === Number(variant.id);\n  });\n\n  var handleWishlistChange = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n\n              if (!loading) {\n                _context.next = 3;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 3:\n              if (customer) {\n                _context.next = 6;\n                break;\n              }\n\n              setModalView('LOGIN_VIEW');\n              return _context.abrupt(\"return\", openModal());\n\n            case 6:\n              setLoading(true);\n              _context.prev = 7;\n\n              if (!itemInWishlist) {\n                _context.next = 13;\n                break;\n              }\n\n              _context.next = 11;\n              return removeItem({\n                id: itemInWishlist.id\n              });\n\n            case 11:\n              _context.next = 15;\n              break;\n\n            case 13:\n              _context.next = 15;\n              return addItem({\n                productId: productId,\n                variantId: variant === null || variant === void 0 ? void 0 : variant.id\n              });\n\n            case 15:\n              setLoading(false);\n              _context.next = 21;\n              break;\n\n            case 18:\n              _context.prev = 18;\n              _context.t0 = _context[\"catch\"](7);\n              setLoading(false);\n\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[7, 18]]);\n    }));\n\n    return function handleWishlistChange(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(\"button\", _objectSpread(_objectSpread({\n    \"aria-label\": \"Add to wishlist\",\n    className: cn({\n      'opacity-50': loading\n    }, className),\n    onClick: handleWishlistChange\n  }, props), {}, {\n    children: /*#__PURE__*/_jsxDEV(Heart, {\n      fill: itemInWishlist ? 'var(--pink)' : 'none'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, _this)\n  }), void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(WishlistButton, \"kQsf2GKaL5VMI96Jz67BjNPnpBw=\", false, function () {\n  return [useWishlist, useAddItem, useRemoveItem, useCustomer, useUI];\n});\n\n_c = WishlistButton;\nexport default WishlistButton;\n\nvar _c;\n\n$RefreshReg$(_c, \"WishlistButton\");","map":{"version":3,"sources":["/Users/thejmdw/workspace/websites/next-commerce-test/components/wishlist/WishlistButton/WishlistButton.tsx"],"names":["React","useState","cn","useUI","Heart","useAddItem","useCustomer","useWishlist","useRemoveItem","WishlistButton","productId","variant","className","props","data","addItem","removeItem","customer","openModal","setModalView","loading","setLoading","itemInWishlist","items","find","item","product_id","Number","variant_id","id","handleWishlistChange","e","preventDefault","variantId"],"mappings":";;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAoBC,QAApB,QAAoC,OAApC;AACA,OAAOC,EAAP,MAAe,YAAf;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,SAASC,KAAT,QAAsB,mBAAtB;AACA,OAAOC,UAAP,MAAuB,kCAAvB;AACA,OAAOC,WAAP,MAAwB,kCAAxB;AACA,OAAOC,WAAP,MAAwB,kCAAxB;AACA,OAAOC,aAAP,MAA0B,qCAA1B;;AAQA,IAAMC,cAAyB,GAAG,SAA5BA,cAA4B,OAK5B;AAAA;;AAAA;;AAAA,MAJJC,SAII,QAJJA,SAII;AAAA,MAHJC,OAGI,QAHJA,OAGI;AAAA,MAFJC,SAEI,QAFJA,SAEI;AAAA,MADDC,KACC;;AAAA,qBACaN,WAAW,EADxB;AAAA,MACIO,IADJ,gBACIA,IADJ;;AAEJ,MAAMC,OAAO,GAAGV,UAAU,EAA1B;AACA,MAAMW,UAAU,GAAGR,aAAa,EAAhC;;AAHI,qBAIuBF,WAAW,EAJlC;AAAA,MAIUW,QAJV,gBAIIH,IAJJ;;AAAA,eAKgCX,KAAK,EALrC;AAAA,MAKIe,SALJ,UAKIA,SALJ;AAAA,MAKeC,YALf,UAKeA,YALf;;AAAA,kBAM0BlB,QAAQ,CAAC,KAAD,CANlC;AAAA,MAMGmB,OANH;AAAA,MAMYC,UANZ,iBAQJ;;;AACA,MAAMC,cAAc,GAAGR,IAAH,aAAGA,IAAH,sCAAGA,IAAI,CAAES,KAAT,gDAAG,YAAaC,IAAb,EACrB;AACA,YAACC,IAAD;AAAA,WACEA,IAAI,CAACC,UAAL,KAAoBC,MAAM,CAACjB,SAAD,CAA1B,IACCe,IAAI,CAACG,UAAN,KAA6BD,MAAM,CAAChB,OAAO,CAACkB,EAAT,CAFrC;AAAA,GAFqB,CAAvB;;AAOA,MAAMC,oBAAoB;AAAA,yEAAG,iBAAOC,CAAP;AAAA;AAAA;AAAA;AAAA;AAC3BA,cAAAA,CAAC,CAACC,cAAF;;AAD2B,mBAGvBZ,OAHuB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA,kBAMtBH,QANsB;AAAA;AAAA;AAAA;;AAOzBE,cAAAA,YAAY,CAAC,YAAD,CAAZ;AAPyB,+CAQlBD,SAAS,EARS;;AAAA;AAW3BG,cAAAA,UAAU,CAAC,IAAD,CAAV;AAX2B;;AAAA,mBAcrBC,cAdqB;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAejBN,UAAU,CAAC;AAAEa,gBAAAA,EAAE,EAAEP,cAAc,CAACO;AAArB,eAAD,CAfO;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,qBAiBjBd,OAAO,CAAC;AACZL,gBAAAA,SAAS,EAATA,SADY;AAEZuB,gBAAAA,SAAS,EAAEtB,OAAF,aAAEA,OAAF,uBAAEA,OAAO,CAAEkB;AAFR,eAAD,CAjBU;;AAAA;AAuBzBR,cAAAA,UAAU,CAAC,KAAD,CAAV;AAvByB;AAAA;;AAAA;AAAA;AAAA;AAyBzBA,cAAAA,UAAU,CAAC,KAAD,CAAV;;AAzByB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAApBS,oBAAoB;AAAA;AAAA;AAAA,KAA1B;;AA6BA,sBACE;AACE,kBAAW,iBADb;AAEE,IAAA,SAAS,EAAE5B,EAAE,CAAC;AAAE,oBAAckB;AAAhB,KAAD,EAA4BR,SAA5B,CAFf;AAGE,IAAA,OAAO,EAAEkB;AAHX,KAIMjB,KAJN;AAAA,2BAME,QAAC,KAAD;AAAO,MAAA,IAAI,EAAES,cAAc,GAAG,aAAH,GAAmB;AAA9C;AAAA;AAAA;AAAA;AAAA;AANF;AAAA;AAAA;AAAA;AAAA,WADF;AAUD,CA5DD;;GAAMb,c;UAMaF,W,EACDF,U,EACGG,a,EACQF,W,EACSH,K;;;KAVhCM,c;AA8DN,eAAeA,cAAf","sourcesContent":["import React, { FC, useState } from 'react'\nimport cn from 'classnames'\nimport { useUI } from '@components/ui'\nimport { Heart } from '@components/icons'\nimport useAddItem from '@framework/wishlist/use-add-item'\nimport useCustomer from '@framework/customer/use-customer'\nimport useWishlist from '@framework/wishlist/use-wishlist'\nimport useRemoveItem from '@framework/wishlist/use-remove-item'\nimport type { Product, ProductVariant } from '@commerce/types'\n\ntype Props = {\n  productId: Product['id']\n  variant: ProductVariant\n} & React.ButtonHTMLAttributes<HTMLButtonElement>\n\nconst WishlistButton: FC<Props> = ({\n  productId,\n  variant,\n  className,\n  ...props\n}) => {\n  const { data } = useWishlist()\n  const addItem = useAddItem()\n  const removeItem = useRemoveItem()\n  const { data: customer } = useCustomer()\n  const { openModal, setModalView } = useUI()\n  const [loading, setLoading] = useState(false)\n\n  // @ts-ignore Wishlist is not always enabled\n  const itemInWishlist = data?.items?.find(\n    // @ts-ignore Wishlist is not always enabled\n    (item) =>\n      item.product_id === Number(productId) &&\n      (item.variant_id as any) === Number(variant.id)\n  )\n\n  const handleWishlistChange = async (e: any) => {\n    e.preventDefault()\n\n    if (loading) return\n\n    // A login is required before adding an item to the wishlist\n    if (!customer) {\n      setModalView('LOGIN_VIEW')\n      return openModal()\n    }\n\n    setLoading(true)\n\n    try {\n      if (itemInWishlist) {\n        await removeItem({ id: itemInWishlist.id! })\n      } else {\n        await addItem({\n          productId,\n          variantId: variant?.id!,\n        })\n      }\n\n      setLoading(false)\n    } catch (err) {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <button\n      aria-label=\"Add to wishlist\"\n      className={cn({ 'opacity-50': loading }, className)}\n      onClick={handleWishlistChange}\n      {...props}\n    >\n      <Heart fill={itemInWishlist ? 'var(--pink)' : 'none'} />\n    </button>\n  )\n}\n\nexport default WishlistButton\n"]},"metadata":{},"sourceType":"module"}