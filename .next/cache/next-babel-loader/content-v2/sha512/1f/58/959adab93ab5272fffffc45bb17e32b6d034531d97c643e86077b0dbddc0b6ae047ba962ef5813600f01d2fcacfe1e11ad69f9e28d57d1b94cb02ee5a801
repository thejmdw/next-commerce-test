{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/thejmdw/workspace/websites/next-commerce-test/components/wishlist/WishlistButton/WishlistButton.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { useState } from 'react';\nimport cn from 'classnames';\nimport { useUI } from '@components/ui';\nimport { Heart } from '@components/icons';\nimport useAddItem from '@framework/wishlist/use-add-item';\nimport useCustomer from '@framework/customer/use-customer';\nimport useWishlist from '@framework/wishlist/use-wishlist';\nimport useRemoveItem from '@framework/wishlist/use-remove-item';\n\nconst WishlistButton = (_ref) => {\n  var _data$items;\n\n  let {\n    productId,\n    variant,\n    className\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"productId\", \"variant\", \"className\"]);\n\n  const {\n    data\n  } = useWishlist();\n  const addItem = useAddItem();\n  const removeItem = useRemoveItem();\n  const {\n    data: customer\n  } = useCustomer();\n  const {\n    openModal,\n    setModalView\n  } = useUI();\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false); // @ts-ignore Wishlist is not always enabled\n\n  const itemInWishlist = data === null || data === void 0 ? void 0 : (_data$items = data.items) === null || _data$items === void 0 ? void 0 : _data$items.find( // @ts-ignore Wishlist is not always enabled\n  item => item.product_id === Number(productId) && item.variant_id === Number(variant.id));\n\n  const handleWishlistChange = async e => {\n    e.preventDefault();\n    if (loading) return; // A login is required before adding an item to the wishlist\n\n    if (!customer) {\n      setModalView('LOGIN_VIEW');\n      return openModal();\n    }\n\n    setLoading(true);\n\n    try {\n      if (itemInWishlist) {\n        await removeItem({\n          id: itemInWishlist.id\n        });\n      } else {\n        await addItem({\n          productId,\n          variantId: variant === null || variant === void 0 ? void 0 : variant.id\n        });\n      }\n\n      setLoading(false);\n    } catch (err) {\n      setLoading(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"button\", _objectSpread(_objectSpread({\n    \"aria-label\": \"Add to wishlist\",\n    className: cn({\n      'opacity-50': loading\n    }, className),\n    onClick: handleWishlistChange\n  }, props), {}, {\n    children: /*#__PURE__*/_jsxDEV(Heart, {\n      fill: itemInWishlist ? 'var(--pink)' : 'none'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this)\n  }), void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n};\n\nexport default WishlistButton;","map":{"version":3,"sources":["/Users/thejmdw/workspace/websites/next-commerce-test/components/wishlist/WishlistButton/WishlistButton.tsx"],"names":["React","useState","cn","useUI","Heart","useAddItem","useCustomer","useWishlist","useRemoveItem","WishlistButton","productId","variant","className","props","data","addItem","removeItem","customer","openModal","setModalView","loading","setLoading","itemInWishlist","items","find","item","product_id","Number","variant_id","id","handleWishlistChange","e","preventDefault","variantId","err"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAoBC,QAApB,QAAoC,OAApC;AACA,OAAOC,EAAP,MAAe,YAAf;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,SAASC,KAAT,QAAsB,mBAAtB;AACA,OAAOC,UAAP,MAAuB,kCAAvB;AACA,OAAOC,WAAP,MAAwB,kCAAxB;AACA,OAAOC,WAAP,MAAwB,kCAAxB;AACA,OAAOC,aAAP,MAA0B,qCAA1B;;AAQA,MAAMC,cAAyB,GAAG,UAK5B;AAAA;;AAAA,MAL6B;AACjCC,IAAAA,SADiC;AAEjCC,IAAAA,OAFiC;AAGjCC,IAAAA;AAHiC,GAK7B;AAAA,MADDC,KACC;;AACJ,QAAM;AAAEC,IAAAA;AAAF,MAAWP,WAAW,EAA5B;AACA,QAAMQ,OAAO,GAAGV,UAAU,EAA1B;AACA,QAAMW,UAAU,GAAGR,aAAa,EAAhC;AACA,QAAM;AAAEM,IAAAA,IAAI,EAAEG;AAAR,MAAqBX,WAAW,EAAtC;AACA,QAAM;AAAEY,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAA8BhB,KAAK,EAAzC;AACA,QAAM;AAAA,OAACiB,OAAD;AAAA,OAAUC;AAAV,MAAwBpB,QAAQ,CAAC,KAAD,CAAtC,CANI,CAQJ;;AACA,QAAMqB,cAAc,GAAGR,IAAH,aAAGA,IAAH,sCAAGA,IAAI,CAAES,KAAT,gDAAG,YAAaC,IAAb,EACrB;AACCC,EAAAA,IAAD,IACEA,IAAI,CAACC,UAAL,KAAoBC,MAAM,CAACjB,SAAD,CAA1B,IACCe,IAAI,CAACG,UAAN,KAA6BD,MAAM,CAAChB,OAAO,CAACkB,EAAT,CAJhB,CAAvB;;AAOA,QAAMC,oBAAoB,GAAG,MAAOC,CAAP,IAAkB;AAC7CA,IAAAA,CAAC,CAACC,cAAF;AAEA,QAAIZ,OAAJ,EAAa,OAHgC,CAK7C;;AACA,QAAI,CAACH,QAAL,EAAe;AACbE,MAAAA,YAAY,CAAC,YAAD,CAAZ;AACA,aAAOD,SAAS,EAAhB;AACD;;AAEDG,IAAAA,UAAU,CAAC,IAAD,CAAV;;AAEA,QAAI;AACF,UAAIC,cAAJ,EAAoB;AAClB,cAAMN,UAAU,CAAC;AAAEa,UAAAA,EAAE,EAAEP,cAAc,CAACO;AAArB,SAAD,CAAhB;AACD,OAFD,MAEO;AACL,cAAMd,OAAO,CAAC;AACZL,UAAAA,SADY;AAEZuB,UAAAA,SAAS,EAAEtB,OAAF,aAAEA,OAAF,uBAAEA,OAAO,CAAEkB;AAFR,SAAD,CAAb;AAID;;AAEDR,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KAXD,CAWE,OAAOa,GAAP,EAAY;AACZb,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD;AACF,GA3BD;;AA6BA,sBACE;AACE,kBAAW,iBADb;AAEE,IAAA,SAAS,EAAEnB,EAAE,CAAC;AAAE,oBAAckB;AAAhB,KAAD,EAA4BR,SAA5B,CAFf;AAGE,IAAA,OAAO,EAAEkB;AAHX,KAIMjB,KAJN;AAAA,2BAME,QAAC,KAAD;AAAO,MAAA,IAAI,EAAES,cAAc,GAAG,aAAH,GAAmB;AAA9C;AAAA;AAAA;AAAA;AAAA;AANF;AAAA;AAAA;AAAA;AAAA,UADF;AAUD,CA5DD;;AA8DA,eAAeb,cAAf","sourcesContent":["import React, { FC, useState } from 'react'\nimport cn from 'classnames'\nimport { useUI } from '@components/ui'\nimport { Heart } from '@components/icons'\nimport useAddItem from '@framework/wishlist/use-add-item'\nimport useCustomer from '@framework/customer/use-customer'\nimport useWishlist from '@framework/wishlist/use-wishlist'\nimport useRemoveItem from '@framework/wishlist/use-remove-item'\nimport type { Product, ProductVariant } from '@commerce/types'\n\ntype Props = {\n  productId: Product['id']\n  variant: ProductVariant\n} & React.ButtonHTMLAttributes<HTMLButtonElement>\n\nconst WishlistButton: FC<Props> = ({\n  productId,\n  variant,\n  className,\n  ...props\n}) => {\n  const { data } = useWishlist()\n  const addItem = useAddItem()\n  const removeItem = useRemoveItem()\n  const { data: customer } = useCustomer()\n  const { openModal, setModalView } = useUI()\n  const [loading, setLoading] = useState(false)\n\n  // @ts-ignore Wishlist is not always enabled\n  const itemInWishlist = data?.items?.find(\n    // @ts-ignore Wishlist is not always enabled\n    (item) =>\n      item.product_id === Number(productId) &&\n      (item.variant_id as any) === Number(variant.id)\n  )\n\n  const handleWishlistChange = async (e: any) => {\n    e.preventDefault()\n\n    if (loading) return\n\n    // A login is required before adding an item to the wishlist\n    if (!customer) {\n      setModalView('LOGIN_VIEW')\n      return openModal()\n    }\n\n    setLoading(true)\n\n    try {\n      if (itemInWishlist) {\n        await removeItem({ id: itemInWishlist.id! })\n      } else {\n        await addItem({\n          productId,\n          variantId: variant?.id!,\n        })\n      }\n\n      setLoading(false)\n    } catch (err) {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <button\n      aria-label=\"Add to wishlist\"\n      className={cn({ 'opacity-50': loading }, className)}\n      onClick={handleWishlistChange}\n      {...props}\n    >\n      <Heart fill={itemInWishlist ? 'var(--pink)' : 'none'} />\n    </button>\n  )\n}\n\nexport default WishlistButton\n"]},"metadata":{},"sourceType":"module"}